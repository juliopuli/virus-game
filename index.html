
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Virus! Modern</title>
    
    <link rel="apple-touch-icon" href="virus.png">
    <link rel="icon" type="image/png" href="virus.png">

    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>
<body>
    
    <div id="license-modal">
        <div class="license-box">
            <div class="license-icon">ğŸ”’</div>
            <h2>Acceso Bloqueado</h2>
            <p id="license-msg">Has agotado tus 10 rondas de prueba.<br>Introduce tu cÃ³digo de licencia para continuar jugando ilimitadamente.</p>
            <input type="text" id="license-key" class="license-input" placeholder="XXXX-XXXX">
            <button onclick="validateLicense()" class="license-btn">DESBLOQUEAR</button>
            <p id="license-error" style="color:red; margin-top:10px; display:none; font-size:0.9rem;">CÃ³digo incorrecto</p>
        </div>
    </div>
    
    <div id="trial-counter" class="trial-info" style="display:none;"></div>

    <div id="rules-modal">
        <div class="rules-content">
            <div class="rules-header">
                <h2>ğŸ“˜ CÃ“MO JUGAR</h2>
                <button class="rules-close-btn" onclick="toggleRules()">Ã—</button>
            </div>
            <div class="rules-body">
                <div class="rules-section">
                    <h3>ğŸ† Objetivo</h3>
                    <div class="rule-item">
                        <div class="rule-icon">â¤ï¸</div>
                        <div>Completa tu cuerpo con <b>4 Ã³rganos sanos</b> de diferente color (Rojo, Azul, Verde, Amarillo) para ganar.</div>
                    </div>
                </div>

                <div class="rules-section">
                    <h3>ğŸ•¹ï¸ Turno</h3>
                    <p>En tu turno, solo puedes hacer <b>UNA</b> de estas dos cosas:</p>
                    <ol>
                        <li><b>Jugar 1 carta:</b> Ponla en tu cuerpo o en el de un rival.</li>
                        <li><b>Descartar:</b> Tira 1, 2 o 3 cartas si no te sirven.</li>
                    </ol>
                    <p><i>*Al final de tu turno, robarÃ¡s automÃ¡ticamente hasta tener 3 cartas.</i></p>
                </div>

                <div class="rules-section">
                    <h3>ğŸ¦  Cartas BÃ¡sicas</h3>
                    <div class="rule-item">
                        <div class="rule-icon">ğŸ«€</div>
                        <div><b>Ã“rgano:</b> Ponlo en tu zona. Solo 1 de cada color.</div>
                    </div>
                    <div class="rule-item">
                        <div class="rule-icon">ğŸ’Š</div>
                        <div><b>Medicina:</b> Cura un virus o protege un Ã³rgano (vacuna). <br>2 Medicinas = <b>Inmunizado</b> (Intocable).</div>
                    </div>
                    <div class="rule-item">
                        <div class="rule-icon">ğŸ¦ </div>
                        <div><b>Virus:</b> Infecta un Ã³rgano sano o destruye una vacuna. <br>2 Virus = <b>Extirpado</b> (Ã“rgano destruido).</div>
                    </div>
                </div>

                <div class="rules-section">
                    <h3>âš¡ Cartas Especiales</h3>
                    <div class="special-cards-grid">
                        <div class="special-card-box"><b>ğŸ¥ Trasplante</b>Intercambia un Ã³rgano tuyo por uno de un rival.</div>
                        <div class="special-card-box"><b>ğŸ§¤ LadrÃ³n</b>Roba un Ã³rgano de un rival para tu cuerpo.</div>
                        <div class="special-card-box"><b>ğŸ¤§ Contagio</b>Pasa tus virus a los Ã³rganos sanos de los demÃ¡s.</div>
                        <div class="special-card-box"><b>ğŸ§¤ Guante LÃ¡tex</b>Todos descartan su mano menos tÃº.</div>
                        <div class="special-card-box"><b>ğŸ” Error MÃ©dico</b>Intercambia TODO tu cuerpo con el de otro jugador.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="main-menu">
        <h1 class="game-title">JUEGO<span class="title-virus">VIRUS</span></h1>

        <div class="menu-box-modern">
            <input type="text" id="username" placeholder="Tu Nombre (ej: Pablo)" class="modern-input" autocomplete="off" maxlength="10">
            
            <button onclick="startLocalGame()" class="modern-btn btn-orange-glow">
                ğŸ‘¤ vs ğŸ¤– (Local)
            </button>
            
            <button onclick="showMultiplayerOptions()" class="modern-btn">
                ğŸ‘¥ Multiplayer (Online)
            </button>

            <button onclick="toggleRules()" class="modern-btn" style="background: #3498db; border-color: #2980b9;">
                ğŸ“˜ CÃ³mo Jugar
            </button>

            <div class="meta-container">
                <label for="target-wins-main">Meta:</label>
                <div class="modern-select-container">
                    <select id="target-wins-main">
                        <option value="3">3 ğŸ†</option>
                        <option value="5" selected>5 ğŸ†</option>
                        <option value="7">7 ğŸ†</option>
                        <option value="10">10 ğŸ†</option>
                    </select>
                </div>
            </div>
            
            <button id="btn-activate-premium" onclick="openLicenseModal(true)" style="margin-top:10px; background:none; border:none; color:#7f8c8d; cursor:pointer; font-size:0.8rem; text-decoration:underline;">
                Â¿Tienes un cÃ³digo? ActÃ­valo aquÃ­
            </button>

            <div id="mp-options" style="display:none;">
                <div class="mp-grid">
                    <button onclick="createRoom()" class="modern-btn mp-btn-half" style="background: #27ae60; border-color:#2ecc71;">Crear Sala</button>
                    <button onclick="joinRoomUI()" class="modern-btn mp-btn-half">Unirse</button>
                </div>
                
                <div id="room-code-display" style="display:none; margin-top: 15px;">
                    <p style="color:#ccc; margin:0;">CÃ“DIGO DE SALA:</p>
                    <h2 id="my-code">...</h2>
                    <div id="lobby-list" style="margin:10px 0; font-size:1rem; min-height: 20px;">
                        Esperando jugadores...
                    </div>
                    <button id="start-game-btn" onclick="hostStartGame()" class="modern-btn btn-orange-glow" style="display:none; margin-top:10px;">
                        Â¡EMPEZAR PARTIDA!
                    </button>
                </div>
                
                <div id="join-input-area" style="display:none; margin-top: 15px;">
                    <input type="text" id="remote-code-input" placeholder="Introduce CÃ³digo" class="modern-input" style="margin-bottom: 10px;">
                    <button onclick="connectToPeer()" class="modern-btn" style="background: #27ae60; border-color:#2ecc71;">Entrar</button>
                </div>
                 <p id="connection-status" style="margin-top: 15px; color: #aaa; font-size: 0.9rem;"></p>
            </div>
        </div>

        <div class="menu-footer-styled">
            ğŸ¤– powered by @aljupa
        </div>
    </div>

    <div id="round-modal">
        <div class="round-content">
            <h2 id="round-title">Â¡GANADOR!</h2>
            <p id="round-message">El jugador X gana la ronda</p>
            <div id="round-scores" style="margin-bottom: 20px; font-weight: bold;"></div>
            <button id="next-round-btn" onclick="continueGame()">CONTINUAR</button>
        </div>
    </div>

    <button id="chat-btn" onclick="toggleChat()" style="display:none;">ğŸ’¬ <span id="chat-badge" style="display:none;">â—</span></button>
    <div id="chat-modal" style="display:none;">
        <div class="chat-content">
            <div class="chat-header"><h3>Chat</h3><button onclick="toggleChat()">âœ–</button></div>
            <div id="chat-history"></div>
            <div class="chat-input-area"><input id="chat-input"><button onclick="sendChatMessage()">â¤</button></div>
        </div>
    </div>

    <div id="game-container" class="blurred">
        <div id="scoreboard-area"></div>
        <div id="notification-bar">...</div>
        
        <div id="rivals-container"></div>

        <div id="deck-area">
            <div id="dynamic-controls"></div>
            <div class="deck-info"><div class="card deck-visual"><span id="deck-count">0</span></div></div>
            <button onclick="confirmExit()" id="restart-btn" style="display:none">Salir</button>
        </div>

        <div class="board-section" id="my-board-section">
            <div id="player-body" class="body-slots"></div>
            <h3>ğŸ‘¤ TU SALUD</h3>
            <div id="player-hand" class="hand"></div>
        </div>
    </div>
    
    <div class="version-display">V.4.9.2</div>
    <script src="script.js"></script>
</body>
</html>


